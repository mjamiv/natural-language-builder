<!DOCTYPE html>
<html>
<head>
<title>NLB Moment Diagram â€” Memphis Bridge</title>
<style>
  body { margin: 0; padding: 20px; background: #1a1a2e; color: #eee; font-family: 'Segoe UI', sans-serif; }
  h1 { color: #e94560; margin-bottom: 5px; }
  h2 { color: #888; font-weight: normal; margin-top: 0; }
  .info { color: #aaa; font-size: 14px; margin-bottom: 10px; }
  canvas { background: #16213e; border: 1px solid #333; border-radius: 8px; }
  .legend { display: flex; gap: 20px; margin-top: 10px; font-size: 14px; }
  .legend span { display: flex; align-items: center; gap: 5px; }
  .legend .pos { color: #00d2ff; }
  .legend .neg { color: #e94560; }
  .stats { margin-top: 15px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
  .stat { background: #16213e; border: 1px solid #333; border-radius: 8px; padding: 12px; }
  .stat .label { color: #888; font-size: 12px; }
  .stat .value { color: #fff; font-size: 24px; font-weight: bold; }
  .stat .unit { color: #666; font-size: 14px; }
</style>
</head>
<body>
<h1>ðŸ”´ Natural Language Builder â€” FEA Results</h1>
<h2>Memphis 4-Span Steel Plate Girder (200-300-300-200 ft)</h2>
<div class="info">Center Girder (G3) â€¢ Gravity Dead Load (DC) â€¢ OpenSeesPy Analysis</div>

<canvas id="c" width="1200" height="500"></canvas>

<div class="legend">
  <span class="pos">â–  Positive Moment (tension bottom)</span>
  <span class="neg">â–  Negative Moment (tension top)</span>
  <span style="color:#666">â€” Support locations</span>
</div>

<div class="stats">
  <div class="stat"><div class="label">Max Positive Moment</div><div class="value" id="maxPos"></div><div class="unit">kip-ft</div></div>
  <div class="stat"><div class="label">Max Negative Moment</div><div class="value" id="maxNeg"></div><div class="unit">kip-ft</div></div>
  <div class="stat"><div class="label">Model Size</div><div class="value">712</div><div class="unit">nodes / 744 elements</div></div>
</div>

<script>
const data = {"x_ft": [5.0, 15.0, 25.0, 35.0, 45.0, 55.0, 65.0, 75.0, 85.0, 95.0, 105.0, 115.0, 125.0, 135.0, 145.0, 155.0, 165.0, 175.0, 185.0, 195.0, 207.5, 207.5, 222.5, 222.5, 237.5, 237.5, 252.5, 252.5, 267.5, 267.5, 282.5, 282.5, 297.5, 297.5, 312.5, 312.5, 327.5, 327.5, 342.5, 342.5, 357.5, 372.5, 387.5, 402.5, 417.5, 432.5, 447.5, 462.5, 477.5, 492.5, 507.5, 522.5, 537.5, 552.5, 567.5, 582.5, 597.5, 612.5, 627.5, 642.5, 657.5, 672.5, 687.5, 702.5, 717.5, 732.5, 747.5, 762.5, 777.5, 792.5, 805.0, 815.0, 825.0, 835.0, 845.0, 855.0, 865.0, 875.0, 885.0, 895.0, 905.0, 915.0, 925.0, 935.0, 945.0, 955.0, 965.0, 975.0, 985.0, 995.0], "M_kft": [400.31756021990344, 1117.7532998464706, 1710.3890102411706, 2178.2246830264708, 2521.2603146631927, 2739.495906379578, 2832.9313731956786, 2801.56703550053, 2645.4026551300544, 2364.4382237352024, 1958.6737384680525, 1428.1092019217585, 772.7446221797418, -7.419623327369979, -912.3839016938673, -1942.1482181524764, -3096.7125755337306, -4376.076972755846, -5780.241404783792, -7309.205862498646, -6804.649533448685, -6804.646524462428, -4370.572901059524, -4370.570774295903, -2217.296251224246, -2217.2950080006235, -344.81958558075286, -344.8192266727899, 1246.8565687389982, 1246.8570944257253, 2557.7323774282463, 2557.733787527866, 3587.8087611497303, 3587.810541098273, 4337.085626743585, 4337.087252175655, 4805.562492906939, 4805.563964267026, 4993.2393595695985, 4993.240677103288, 4900.117390468079, 4526.194104194484, 3871.47081816169, 2935.947532400052, 1719.624249682943, 222.5009668267132, -1555.4223162249712, -3614.145599465972, -5953.668882827216, -8573.992166175643, -8573.992259625249, -5953.669145162215, -3614.1460306875474, -1555.4229163290076, 222.50019785431857, 1719.6233118712298, 2935.946425431586, 3871.469536711478, 4526.192648051964, 4900.115759529911, 4993.238871273887, 4805.561983465334, 4337.08509634275, 3587.8081838577205, 2557.7313122183773, 1246.8544495001058, -344.8224032378999, -2217.2992447889023, -4370.576073783034, -6804.652888671746, -7309.209344882805, -5780.244678304957, -4376.080037063865, -3096.7154288364395, -1942.1508572611176, -912.3863220358517, -7.421948054095396, 772.7427523452872, 1428.1074126678843, 1958.672023995494, 2364.4365826749768, 2645.4010902463274, 2801.5655534754974, 2832.9301907356453, 2739.4948538708177, 2521.2594770149344, 2178.2240562750108, 1710.3885921918036, 1117.753089751036, 400.31755848446284], "spans": [200, 300, 300, 200], "supports_ft": [0, 200, 500, 800, 1000], "bridge": "Memphis 4-Span Steel Plate Girder (200-300-300-200 ft)", "girder": "Center (G3)"};
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height;
const pad = { left: 80, right: 30, top: 40, bottom: 50 };
const pw = W - pad.left - pad.right;
const ph = H - pad.top - pad.bottom;

const x = data.x_ft;
const m = data.M_kft;
const supports = data.supports_ft;
const xMin = 0, xMax = Math.max(...x, ...supports);
const mMin = Math.min(...m), mMax = Math.max(...m);
const mAbsMax = Math.max(Math.abs(mMin), Math.abs(mMax)) * 1.1;

function tx(v) { return pad.left + (v - xMin) / (xMax - xMin) * pw; }
function ty(v) { return pad.top + ph/2 - (v / mAbsMax) * (ph/2); }

// Grid
ctx.strokeStyle = '#2a2a4a';
ctx.lineWidth = 0.5;
for (let i = -1; i <= 1; i += 0.5) {
  const yy = ty(i * mAbsMax);
  ctx.beginPath(); ctx.moveTo(pad.left, yy); ctx.lineTo(W - pad.right, yy); ctx.stroke();
}

// Zero line
ctx.strokeStyle = '#444';
ctx.lineWidth = 1;
ctx.beginPath();
ctx.moveTo(pad.left, ty(0));
ctx.lineTo(W - pad.right, ty(0));
ctx.stroke();

// Supports
ctx.strokeStyle = '#666';
ctx.setLineDash([4, 4]);
for (const s of supports) {
  const sx = tx(s);
  ctx.beginPath(); ctx.moveTo(sx, pad.top); ctx.lineTo(sx, H - pad.bottom); ctx.stroke();
  ctx.fillStyle = '#888';
  ctx.font = '11px monospace';
  ctx.textAlign = 'center';
  ctx.fillText(s + ' ft', sx, H - pad.bottom + 15);
  // Triangle
  ctx.setLineDash([]);
  ctx.beginPath();
  ctx.moveTo(sx - 8, ty(0) + 4);
  ctx.lineTo(sx + 8, ty(0) + 4);
  ctx.lineTo(sx, ty(0));
  ctx.closePath();
  ctx.fillStyle = '#555';
  ctx.fill();
  ctx.setLineDash([4, 4]);
}
ctx.setLineDash([]);

// Moment diagram (filled)
ctx.beginPath();
ctx.moveTo(tx(x[0]), ty(0));
for (let i = 0; i < x.length; i++) {
  ctx.lineTo(tx(x[i]), ty(m[i]));
}
ctx.lineTo(tx(x[x.length-1]), ty(0));
ctx.closePath();

// Gradient fill
const grad = ctx.createLinearGradient(0, ty(mMax), 0, ty(mMin));
grad.addColorStop(0, 'rgba(0, 210, 255, 0.3)');
grad.addColorStop(0.5, 'rgba(100, 100, 100, 0.1)');
grad.addColorStop(1, 'rgba(233, 69, 96, 0.3)');
ctx.fillStyle = grad;
ctx.fill();

// Moment line
for (let i = 1; i < x.length; i++) {
  ctx.strokeStyle = m[i] >= 0 ? '#00d2ff' : '#e94560';
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.moveTo(tx(x[i-1]), ty(m[i-1]));
  ctx.lineTo(tx(x[i]), ty(m[i]));
  ctx.stroke();
}

// Y-axis labels
ctx.fillStyle = '#888';
ctx.font = '11px monospace';
ctx.textAlign = 'right';
for (let i = -1; i <= 1; i += 0.5) {
  const val = Math.round(i * mAbsMax);
  ctx.fillText(val.toLocaleString() + ' k-ft', pad.left - 8, ty(i * mAbsMax) + 4);
}

// Title
ctx.fillStyle = '#eee';
ctx.font = 'bold 14px sans-serif';
ctx.textAlign = 'left';
ctx.fillText('Bending Moment Diagram (Mz) â€” Gravity Dead Load', pad.left, 25);

// Max/min annotations
const maxIdx = m.indexOf(Math.max(...m));
const minIdx = m.indexOf(Math.min(...m));
ctx.fillStyle = '#00d2ff';
ctx.font = '12px monospace';
ctx.textAlign = 'center';
ctx.fillText('+' + Math.round(m[maxIdx]).toLocaleString() + ' k-ft', tx(x[maxIdx]), ty(m[maxIdx]) - 10);
ctx.fillStyle = '#e94560';
ctx.fillText(Math.round(m[minIdx]).toLocaleString() + ' k-ft', tx(x[minIdx]), ty(m[minIdx]) + 20);

// Stats
document.getElementById('maxPos').textContent = '+' + Math.round(Math.max(...m)).toLocaleString();
document.getElementById('maxNeg').textContent = Math.round(Math.min(...m)).toLocaleString();
</script>
</body>
</html>
